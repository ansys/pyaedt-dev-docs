
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>User Guide &#8212; PyAEDT 0.5.dev1
 documentation</title>
    
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Documentation" href="../API/index.html" />
    <link rel="prev" title="Installation" href="Installation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><style>
    .navbar-light {
        background-color: black !important;
    }
</style>

<div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://aedtdocs.pyansys.com/">
  <img src="../_static/pyansys-logo-black-cropped.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon" >
      <i class="fas fa-bars" style="color:#fff; font-size:28px;"></i>
    </span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="Installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="current reference internal nav-link" href="#">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../API/index.html">
  API Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="Code_Guidelines.html">
  Code Guidelines
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="Contributing.html">
  Contributing
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/PyAEDT" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    
    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#variables">
   Variables
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeler">
   Modeler
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mesh">
   Mesh
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#optimization">
   Optimization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#client-server">
   Client/Server
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cpython-on-linux-with-client-server">
   CPython on Linux with Client-Server
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this headline">Â¶</a></h1>
<p>PyAEDT works both inside AEDT and as a standalone application.
It automatically detects whether it is running in an IronPython or CPython
environment and initializes AEDT accordingly. PyAEDT also provides
advanced error management.</p>
<p>AEDT can be started from Python in the non-graphical mode using AEDT.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Launch</span> <span class="n">AEDT</span> <span class="mi">2021</span> <span class="n">R1</span> <span class="ow">in</span> <span class="n">Non</span><span class="o">-</span><span class="n">Graphical</span> <span class="n">mode</span>

<span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Desktop</span><span class="p">,</span> <span class="n">Circuit</span>
<span class="k">with</span> <span class="n">Desktop</span><span class="p">(</span><span class="n">specified_version</span><span class="o">=</span><span class="s2">&quot;2021.1&quot;</span><span class="p">,</span> <span class="n">non_graphical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">new_desktop_session</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">close_on_exit</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">student_version</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="o">...</span>
    <span class="c1"># Any error here will be caught by Desktop.</span>
    <span class="o">...</span>

<span class="c1"># Desktop is automatically closed here.</span>
</pre></div>
</div>
<p>The previous command launches AEDT and initializes a new Circuit design.</p>
<a class="reference internal image-reference" href="../_images/aedt_first_page.png"><img alt="Electronics Desktop Launched" src="../_images/aedt_first_page.png" style="width: 800px;" /></a>
<p>The same result can be obtained with the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of AEDT in graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Circuit</span>
<span class="k">with</span> <span class="n">Circuit</span><span class="p">(</span><span class="n">specified_version</span><span class="o">=</span><span class="s2">&quot;2021.1&quot;</span><span class="p">,</span> <span class="n">non_graphical</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">circuit</span><span class="p">:</span>
    <span class="o">...</span>
    <span class="c1"># Any error here will be caught by Desktop.</span>
    <span class="o">...</span>

<span class="c1"># Desktop is automatically released here.</span>
</pre></div>
</div>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Permalink to this headline">Â¶</a></h2>
<p>PyAEDT provides a simplified interface for getting and setting variables inside a project or a design.
You simply need to initialize a variable as a dictionary key. If you use <code class="docutils literal notranslate"><span class="pre">$</span></code> as the prefix
for the variable name, a project-wide variable is created.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Hfss</span>
<span class="k">with</span> <span class="n">Hfss</span> <span class="k">as</span> <span class="n">hfss</span><span class="p">:</span>
     <span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1mm&quot;</span>   <span class="c1"># design variable</span>
     <span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;$dim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1mm&quot;</span>  <span class="c1"># project variable</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/aedt_variables.png"><img alt="Variable Management" src="../_images/aedt_variables.png" style="width: 800px;" /></a>
<p>Variable Manager allows user to create advanced equations and manage them through PyAEDT.</p>
<p>The Variable value can be set or get using application setter and getter but user can access
more comprehensive set of functions by accessing directly the variable_manager object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;$PrjVar1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;2*pi&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;$PrjVar2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;100Hz&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;$PrjVar3&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;34 * $PrjVar1/$PrjVar2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;$PrjVar3&quot;</span><span class="p">]</span>
<span class="go">2.13628300444106</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hfss</span><span class="p">[</span><span class="s2">&quot;$PrjVar3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
<span class="go">2.13628300444106</span>
<span class="go">hfss.variable_manager[&quot;$PrjVar3&quot;].expression</span>
<span class="go">&#39;34 * $PrjVar1/$PrjVar2&#39;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/variables_advanced.png"><img alt="Variable Management" src="../_images/variables_advanced.png" style="width: 600px;" /></a>
</section>
<section id="modeler">
<h2>Modeler<a class="headerlink" href="#modeler" title="Permalink to this headline">Â¶</a></h2>
<p>Object-oriented programming is used to create and manage objects in the AEDT 3D and 2D Modelers.
You can create an object and change properties using getters and setters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Create</span> <span class="n">a</span> <span class="n">box</span><span class="p">,</span> <span class="n">assign</span> <span class="n">variables</span><span class="p">,</span> <span class="ow">and</span> <span class="n">assign</span> <span class="n">materials</span><span class="o">.</span>

<span class="kn">from</span> <span class="nn">pyaedt.hfss</span> <span class="kn">import</span> <span class="n">Hfss</span>
<span class="k">with</span> <span class="n">Hfss</span> <span class="k">as</span> <span class="n">hfss</span><span class="p">:</span>
     <span class="n">box</span> <span class="o">=</span> <span class="n">hfss</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_box</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="s2">&quot;dim&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                                   <span class="s2">&quot;mybox&quot;</span><span class="p">,</span> <span class="s2">&quot;aluminum&quot;</span><span class="p">)</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">box</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
     <span class="n">box</span><span class="o">.</span><span class="n">material_name</span> <span class="o">=</span> <span class="s2">&quot;copper&quot;</span>
     <span class="n">box</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;Red&quot;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/aedt_box.png"><img alt="Modeler Object" src="../_images/aedt_box.png" style="width: 800px;" /></a>
<p>Once an object is created or is present in the design (from a loaded project), user can
simply get the related object using getters. Getter works either with object id or object name.
Object returned has all features even if it has not been created in PyAEDT.
Next example shows how easily user can go deeper into edges and vertices of faces or 3d objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span> <span class="o">=</span> <span class="n">hfss</span><span class="o">.</span><span class="n">modeler</span><span class="p">[</span><span class="s2">&quot;mybox2&quot;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="n">box</span><span class="o">.</span><span class="n">faces</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">face</span><span class="o">.</span><span class="n">center</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">face</span><span class="p">:</span>
       <span class="nb">print</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">midpoint</span><span class="p">)</span>
       <span class="k">for</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="n">edge</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
           <span class="nb">print</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
<span class="k">for</span> <span class="n">vertice</span> <span class="ow">in</span> <span class="n">box</span><span class="o">.</span><span class="n">vertices</span><span class="p">:</span>
   <span class="nb">print</span><span class="p">(</span><span class="n">edge</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</pre></div>
</div>
<p>All objects allow to execute any modeler operations like union or subtraction.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span> <span class="o">=</span> <span class="n">hfss</span><span class="o">.</span><span class="n">modeler</span><span class="p">[</span><span class="s2">&quot;mybox2&quot;</span><span class="p">]</span>
<span class="n">cyl</span> <span class="o">=</span> <span class="n">hfss</span><span class="o">.</span><span class="n">modeler</span><span class="p">[</span><span class="s2">&quot;mycyl&quot;</span><span class="p">]</span>
<span class="n">box</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="n">cyl</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/objects_operations.gif"><img alt="Object Modeler Operations" src="../_images/objects_operations.gif" style="width: 800px;" /></a>
</section>
<section id="mesh">
<h2>Mesh<a class="headerlink" href="#mesh" title="Permalink to this headline">Â¶</a></h2>
<p>Mesh operations are very important in Engineering Simulation. PyAEDT is able to read all mesh
operations already present in a design, edit them and create new ones.
All mesh operations are listed into mesh object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Maxwell3d</span>
<span class="n">m3d</span> <span class="o">=</span> <span class="n">Maxwell3d</span><span class="p">()</span>
<span class="n">all_mesh_ops</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">meshoperations</span>
<span class="n">my_mesh_op</span> <span class="o">=</span> <span class="n">all_mesh_ops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># all properties are in props dictionary.</span>
<span class="n">my_mesh_op</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s2">&quot;my_prop&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;my_value&quot;</span>
<span class="n">my_mesh_op</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/Mesh_Operations.png"><img alt="Mesh object List" src="../_images/Mesh_Operations.png" style="width: 800px;" /></a>
</section>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">Â¶</a></h2>
<p>Setup, Optimetrics and Sweeps are the last operations before running analysis.
PyAEDT is able to read all setups, sweeps and optimetrics already present in a design,
edit them and create new ones.
All setup operations are listed into setups list.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Maxwell3d</span>
<span class="n">m3d</span> <span class="o">=</span> <span class="n">Maxwell3d</span><span class="p">()</span>
<span class="n">all_setups</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">setups</span>
<span class="n">my_setup</span> <span class="o">=</span> <span class="n">all_setups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># all properties are in props dictionary.</span>
<span class="n">my_setup</span><span class="o">.</span><span class="n">props</span><span class="p">[</span><span class="s1">&#39;MaximumPasses&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">my_setup</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<span class="n">new_setup</span> <span class="o">=</span> <span class="n">m3d</span><span class="o">.</span><span class="n">create_setup</span><span class="p">(</span><span class="s2">&quot;New_Setup&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/Setups.png"><img alt="Setup Editing and Creation" src="../_images/Setups.png" style="width: 800px;" /></a>
</section>
<section id="optimization">
<h2>Optimization<a class="headerlink" href="#optimization" title="Permalink to this headline">Â¶</a></h2>
<p>Optimetrics allows user to setup parametric analysis, sensitivity analysis, optimization and DOE.
PyAEDT is able to read all optimetrics setup already present in a design and create new ones.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyaedt</span> <span class="kn">import</span> <span class="n">Maxwell3d</span>
<span class="n">m3d</span> <span class="o">=</span> <span class="n">Maxwell3d</span><span class="p">()</span>
<span class="n">m3d</span><span class="o">.</span><span class="n">opti_parametric</span><span class="o">.</span><span class="n">add_parametric_setup</span><span class="p">(</span><span class="s2">&quot;Rload&quot;</span><span class="p">,</span> <span class="s2">&quot;LIN 0.1 1 0.1&quot;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/Optimetrics_Parametric.png"><img alt="Optimetrics Creation" src="../_images/Optimetrics_Parametric.png" style="width: 800px;" /></a>
</section>
<section id="client-server">
<h2>Client/Server<a class="headerlink" href="#client-server" title="Permalink to this headline">Â¶</a></h2>
<p>Pyaedt can also be launched on a remote machine. To do that, the following conditions are needed:</p>
<ol class="arabic simple">
<li><p>Pyaedt has to be installed on Client and Server machines</p></li>
<li><p>No need to have AEDT installed on client machine</p></li>
<li><p>Same Python version has to be used on client and server (CPython 3.6+ or IronPython embedded in AEDT Installation)</p></li>
</ol>
<p>Here one example of usage on Windows Server or Linux Server (IronPython):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of AEDT in graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt.common_rpc</span> <span class="kn">import</span> <span class="n">launch_server</span>
<span class="c1"># ansysem_path and non_graphical are needed only for Linux Ironpython Server</span>
<span class="n">launch_server</span><span class="p">(</span><span class="n">ansysem_path</span><span class="o">=</span><span class="s2">&quot;/path/to/ansys/executable/folder&quot;</span><span class="p">,</span> <span class="n">non_graphical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>On Client Side:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of AEDT in graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt.common_rpc</span> <span class="kn">import</span> <span class="n">client</span>
<span class="n">my_client</span> <span class="o">=</span> <span class="n">client</span><span class="p">(</span><span class="s2">&quot;full_name_of_server&quot;</span><span class="p">)</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">my_client</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">circuit</span><span class="p">(</span><span class="n">specified_version</span><span class="o">=</span><span class="s2">&quot;2021.2&quot;</span><span class="p">,</span> <span class="n">non_graphical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">...</span>
<span class="c1"># code like locally</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Here one example of usage on Linux Server (CPython):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of AEDT in graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt.common_rpc</span> <span class="kn">import</span> <span class="n">launch_server</span>
<span class="n">launch_server</span><span class="p">()</span>
</pre></div>
</div>
<p>On Client Side:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of AEDT in graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt.common_rpc</span> <span class="kn">import</span> <span class="n">client</span>
<span class="n">my_client</span> <span class="o">=</span> <span class="n">client</span><span class="p">(</span><span class="s2">&quot;full_name_of_server&quot;</span><span class="p">)</span>
<span class="n">example_script</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;from pyaedt import Circuit&quot;</span><span class="p">,</span> <span class="s2">&quot;circuit=&quot;</span><span class="n">Circuit</span><span class="p">()</span><span class="s2">&quot;, &quot;</span><span class="n">circuit</span><span class="o">.</span><span class="n">save_project</span><span class="p">(</span>\<span class="s2">&quot;project_name</span><span class="se">\&quot;</span><span class="s2">)&quot;</span><span class="p">]</span>
<span class="n">ansysem</span> <span class="o">=</span> <span class="s2">&quot;/path/to/AnsysEMxxx/Linux64&quot;</span>
<span class="n">my_client</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">run_script</span><span class="p">(</span><span class="n">example_script</span><span class="p">,</span> <span class="n">ansysem_path</span><span class="o">=</span><span class="n">ansysem</span><span class="p">)</span>
<span class="n">my_client</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">run_script</span><span class="p">(</span><span class="n">example_script</span><span class="p">,</span> <span class="n">aedt_version</span><span class="o">=</span><span class="s2">&quot;2021.2&quot;</span><span class="p">)</span> <span class="c1">#if ANSYSEM_ROOTxxx env variable is present</span>
</pre></div>
</div>
<p>As an alternative, the user can upload the script to run to the server and run it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of AEDT in graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt.common_rpc</span> <span class="kn">import</span> <span class="n">client</span><span class="p">,</span> <span class="n">upload</span>
<span class="n">my_client</span> <span class="o">=</span> <span class="n">client</span><span class="p">(</span><span class="s2">&quot;full_name_of_server&quot;</span><span class="p">)</span>
<span class="n">local_script</span> <span class="o">=</span><span class="s2">&quot;path/to/my/local/pyaedt/script.py&quot;</span>
<span class="n">remote_script</span> <span class="o">=</span><span class="s2">&quot;path/to/my/remote/pyaedt/script.py&quot;</span>
<span class="n">upload</span><span class="p">(</span><span class="n">local_script</span><span class="p">,</span> <span class="n">remote_script</span><span class="p">,</span> <span class="s2">&quot;servername&quot;</span><span class="p">)</span>
<span class="n">ansysem</span> <span class="o">=</span> <span class="s2">&quot;/path/to/AnsysEMxxx/Linux64&quot;</span>
<span class="n">my_client</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">run_script</span><span class="p">(</span><span class="n">remote_script</span><span class="p">,</span> <span class="n">ansysem_path</span><span class="o">=</span><span class="n">ansysem</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="cpython-on-linux-with-client-server">
<h2>CPython on Linux with Client-Server<a class="headerlink" href="#cpython-on-linux-with-client-server" title="Permalink to this headline">Â¶</a></h2>
<p>To bypass current IronPython limits, you can launch PyAEDT on a Linux machine:</p>
<ol class="arabic simple">
<li><p>Using pip, install PyAEDT 0.4.23 or later on a Linux machine.</p></li>
<li><p>Launche CPython and run PyAEDT.</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Launch the latest installed version of PyAEDT in non-graphical mode.</span>

<span class="kn">from</span> <span class="nn">pyaedt.common_rpc</span> <span class="kn">import</span> <span class="n">launch_ironpython_server</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">launch_ironpython_server</span><span class="p">(</span><span class="n">ansysem_path</span><span class="o">=</span><span class="s2">&quot;/path/to/ansys/executable/folder&quot;</span><span class="p">,</span> <span class="n">non_graphical</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">18000</span><span class="p">)</span>
<span class="n">hfss</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">hfss</span><span class="p">()</span>
<span class="c1"># put your code here</span>
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li><p>If the method returns a list or dictionary, use the following method to work around an
issue with CPython handling:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box1</span> <span class="o">=</span> <span class="n">hfss</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">create_box</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># convert_remote_object method convert remote ironpython list to local cpython.</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">convert_remote_object</span><span class="p">(</span><span class="n">box1</span><span class="o">.</span><span class="n">faces</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/IronPython2Cpython.png"><img alt="Electronics Desktop Launched" src="../_images/IronPython2Cpython.png" style="width: 800px;" /></a>
</section>
</section>


              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright (c) 2022 ANSYS, Inc. All rights reserved.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.0.3.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>
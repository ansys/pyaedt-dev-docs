
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyaedt.maxwell &#8212; PyAEDT</title>
    
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="/opt/hostedtoolcache/Python/3.8.12/x64/lib/python3.8/site-packages/pyansys_sphinx_theme/static/css/pyansys_sphinx_theme.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    
        <link href="../../_static/css/breadcrumbs.css" rel="stylesheet">
    
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><style>
    .navbar-light {
        background-color: black !important;
    }
</style>

<div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://docs.pyansys.com/">
  <img src="../../_static/pyansys-logo-black-cropped.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon" >
      <i class="fas fa-bars" style="color:#fff; font-size:28px;"></i>
    </span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Resources/Installation.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Resources/User_Guide.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Resources/ClientServer.html">
  Client/Server
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../API/index.html">
  API Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Resources/Code_Guidelines.html">
  Code Guidelines
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../Resources/Contributing.html">
  Contributing
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    
    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/pyansys/pyaedt" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>
</div>
    </nav>
    
    
        <div class="container-xl">
    <div class="row">
        <div class="col-12 col-md-3" id="breadcrumbs-spacer"></div>
        <div class="col-12 col-md-11 col-xl-9" id="breadcrumbs">
          
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
    
        <li class="nav-item nav-item-additional-breadcrumb"><a href="https://docs.pyansys.com/">PyAnsys</a> » </li>
    
    
        <li class="nav-item nav-item-0"><a href="../../index.html">PyAEDT</a> » </li>
    

          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> » </li>
        <li class="nav-item nav-item-this"><a href="">pyaedt.maxwell</a></li> 
      </ul>
    </div>
        </div>
  </div>
</div>
    


    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
    
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pyaedt.maxwell</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module contains these Maxwell classes: ``Maxwell``, ``Maxwell2d``, and ``Maxwell3d``.&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>  <span class="c1"># noreorder</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>

<span class="kn">from</span> <span class="nn">pyaedt.application.Analysis3D</span> <span class="kn">import</span> <span class="n">FieldAnalysis3D</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.constants</span> <span class="kn">import</span> <span class="n">SOLUTIONS</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.DataHandlers</span> <span class="kn">import</span> <span class="n">float_units</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.general_methods</span> <span class="kn">import</span> <span class="n">generate_unique_name</span>
<span class="kn">from</span> <span class="nn">pyaedt.generic.general_methods</span> <span class="kn">import</span> <span class="n">pyaedt_function_handler</span>
<span class="kn">from</span> <span class="nn">pyaedt.modeler.GeometryOperators</span> <span class="kn">import</span> <span class="n">GeometryOperators</span>
<span class="kn">from</span> <span class="nn">pyaedt.modules.Boundary</span> <span class="kn">import</span> <span class="n">BoundaryObject</span><span class="p">,</span> <span class="n">MaxwellParameters</span>


<span class="k">class</span> <span class="nc">Maxwell</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_odefinition_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">odefinition_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_omaterial_manager</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">omaterial_manager</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_o_maxwell_parameters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">GetModule</span><span class="p">(</span><span class="s2">&quot;MaxwellParameterSetup&quot;</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">o_maxwell_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AEDT Maxwel Parameter Setup Object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oDesign.GetModule(&quot;MaxwellParameterSetup&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_o_maxwell_parameters</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">omodelsetup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;AEDT Model Setup Object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oDesign.GetModule(&quot;ModelSetup&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">!=</span> <span class="s2">&quot;Transient&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_odesign</span><span class="o">.</span><span class="n">GetModule</span><span class="p">(</span><span class="s2">&quot;ModelSetup&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">symmetry_multiplier</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Symmetry multiplier.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.GetSymmetryMultiplier()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omodelsetup</span><span class="o">.</span><span class="n">GetSymmetryMultiplier</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">windings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Windings.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.GetExcitationsOfType(&quot;Winding Group&quot;)&quot;&quot;&quot;</span>
        <span class="n">windings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">GetExcitationsOfType</span><span class="p">(</span><span class="s2">&quot;Winding Group&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">windings</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">design_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Design file.&quot;&quot;&quot;</span>
        <span class="n">design_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s2">&quot;design_data.json&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">design_file</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">change_symmetry_multiplier</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the Design Symmetry Multiplier to the selected value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int, optional</span>
<span class="sd">            Value used as the Design Symmetry Multiplier coefficient. The default value is ``1``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_design_settings</span><span class="p">({</span><span class="s2">&quot;Multiplier&quot;</span><span class="p">:</span> <span class="n">value</span><span class="p">})</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">change_inductance_computation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compute_transient_inductance</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">incremental_matrix</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Enable the inductance computation for the transient analysis and set the incremental matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        compute_transient_inductance : bool, optional</span>
<span class="sd">            Whether to enable the inductance calculation for the transient analysis.</span>
<span class="sd">            The default is ``True``.</span>
<span class="sd">        incremental_matrix : bool, optional</span>
<span class="sd">            Whether to set the inductance calculation to ``Incremental`` if</span>
<span class="sd">            ``compute_transient_inductance=True``. The default is ``False``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oDesign.SetDesignSettings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_design_settings</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;ComputeTransientInductance&quot;</span><span class="p">:</span> <span class="n">compute_transient_inductance</span><span class="p">,</span> <span class="s2">&quot;ComputeIncrementalMatrix&quot;</span><span class="p">:</span> <span class="n">incremental_matrix</span><span class="p">}</span>
        <span class="p">)</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_core_losses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Whether to enable core losses for a set of objects.</span>

<span class="sd">        This method works only on ``EddyCurrent`` and ``Transient`` solutions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        objects : list, str</span>
<span class="sd">            List of object to apply core losses to.</span>
<span class="sd">        value : bool, optional</span>
<span class="sd">            Whether to enable core losses for the given list. The default is</span>
<span class="sd">            ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.SetCoreLoss</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Set core losses in Maxwell 3D.</span>

<span class="sd">        &gt;&gt;&gt; from pyaedt import Maxwell3d</span>
<span class="sd">        &gt;&gt;&gt; maxwell_3d = Maxwell3d()</span>
<span class="sd">        &gt;&gt;&gt; maxwell_3d.set_core_losses([&quot;PQ_Core_Bottom&quot;, &quot;PQ_Core_Top&quot;], True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;EddyCurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient&quot;</span><span class="p">]:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">SetCoreLoss</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Core losses is only available with `EddyCurrent` and `Transient` solutions.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_matrix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">sources</span><span class="p">,</span>
        <span class="n">matrix_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">turns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">return_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">group_sources</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">branches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a matrix to the selection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sources : list, str</span>
<span class="sd">            List of sources to assign a matrix to.</span>
<span class="sd">        matrix_name : str, optional</span>
<span class="sd">            Name of the matrix. The default is ``None``.</span>
<span class="sd">        turns : list, int, optional</span>
<span class="sd">            Number of turns. The default is 1.</span>
<span class="sd">        return_path : list, str, optional</span>
<span class="sd">            Return path. The default is ``infinite``</span>
<span class="sd">        group_sources : dict, list optional</span>
<span class="sd">            Dictionary consisting of ``{Group Name: list of source names}``. This dictionary is used to add</span>
<span class="sd">            multiple groups. A list of strings could be also defined. The default is not define a group.</span>
<span class="sd">        branches : : list, int, optional</span>
<span class="sd">            Number of branches. The default is 1.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignMatrix</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Set matrix in a Maxwell analysis.</span>

<span class="sd">        &gt;&gt;&gt; m2d = Maxwell2d(solution_type=&quot;MagnetostaticXY&quot;, close_on_exit=True, specified_version=&quot;2022.1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; coil1 = m2d.modeler.create_rectangle([0, 1.5, 0], [8, 3], is_covered=True, name=&quot;Coil_1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; coil2 = m2d.modeler.create_rectangle([8.5, 1.5, 0], [8, 3], is_covered=True, name=&quot;Coil_2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; coil3 = m2d.modeler.create_rectangle([16, 1.5, 0], [8, 3], is_covered=True, name=&quot;Coil_3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; coil4 = m2d.modeler.create_rectangle([32, 1.5, 0], [8, 3], is_covered=True, name=&quot;Coil_4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; current1 = m2d.assign_current(&quot;Coil_1&quot;, amplitude=1, swap_direction=False, name=&quot;Current1&quot;)</span>
<span class="sd">        &gt;&gt;&gt; current2 = m2d.assign_current(&quot;Coil_2&quot;, amplitude=1, swap_direction=True, name=&quot;Current2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; current3 = m2d.assign_current(&quot;Coil_3&quot;, amplitude=1, swap_direction=True, name=&quot;Current3&quot;)</span>
<span class="sd">        &gt;&gt;&gt; current4 = m2d.assign_current(&quot;Coil_4&quot;, amplitude=1, swap_direction=True, name=&quot;Current4&quot;)</span>
<span class="sd">        &gt;&gt;&gt; group_sources = {&quot;Group1_Test&quot;: [&quot;Current1&quot;, &quot;Current3&quot;], &quot;Group2_Test&quot;: [&quot;Current2&quot;, &quot;Current4&quot;]}</span>
<span class="sd">        &gt;&gt;&gt; selection = [&#39;Current1&#39;, &#39;Current2&#39;, &#39;Current3&#39;, &#39;Current4&#39;]</span>
<span class="sd">        &gt;&gt;&gt; turns = [5, 1, 2, 3]</span>
<span class="sd">        &gt;&gt;&gt; L = m2d.assign_matrix(sources=selection, matrix_name=&quot;Test2&quot;, turns=turns, group_sources=group_sources)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">sources</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Electrostatic&quot;</span><span class="p">,</span> <span class="s2">&quot;ACConduction&quot;</span><span class="p">,</span> <span class="s2">&quot;DCConduction&quot;</span><span class="p">]:</span>
            <span class="n">turns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
            <span class="n">branches</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_type</span> <span class="o">==</span> <span class="s2">&quot;Maxwell 2D&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">group_sources</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_sources</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">first_key</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">group_sources</span><span class="p">))</span>
                        <span class="n">group_sources</span> <span class="o">=</span> <span class="n">group_sources</span><span class="p">[</span><span class="n">first_key</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;First Ground is selected&quot;</span><span class="p">)</span>
                    <span class="n">group_sources</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">group_sources</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">group_sources</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Ground must be different than selected sources&quot;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group_sources</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;EddyCurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;Magnetostatic&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;Magnetostatic&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">group_sources</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_sources</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">)):</span>
                        <span class="n">new_group</span> <span class="o">=</span> <span class="n">group_sources</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">new_group</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">sources</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">group_sources</span><span class="p">[</span><span class="n">element</span><span class="p">]):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Sources in group &quot;</span> <span class="o">+</span> <span class="n">element</span> <span class="o">+</span> <span class="s2">&quot; are not selected&quot;</span><span class="p">)</span>
                                <span class="n">group_sources</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">branches</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_sources</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">branches</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                        <span class="p">):</span>
                            <span class="k">if</span> <span class="n">branches</span><span class="p">:</span>
                                <span class="n">branches</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">branches</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                                <span class="n">num</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">group_sources</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">branches</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_sources</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">branches</span><span class="p">,</span> <span class="kc">True</span><span class="p">)):</span>
                                    <span class="n">branches</span> <span class="o">=</span> <span class="n">branches</span><span class="p">[:</span><span class="o">-</span><span class="n">num</span><span class="p">]</span>
                                <span class="k">else</span><span class="p">:</span>
                                    <span class="n">new_element</span> <span class="o">=</span> <span class="p">[</span><span class="n">branches</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">num</span>
                                    <span class="n">branches</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_element</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">branches</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_sources</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">group_sources</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="n">group_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Group&quot;</span><span class="p">)</span>
                        <span class="n">group_sources</span> <span class="o">=</span> <span class="p">{</span><span class="n">group_name</span><span class="p">:</span> <span class="n">group_sources</span><span class="p">}</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Group of sources is not a dictionary&quot;</span><span class="p">)</span>
                        <span class="n">group_sources</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group_sources</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">branches</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">turns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Infinite is the only return path option in EddyCurrent&quot;</span><span class="p">)</span>
                <span class="n">return_path</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;infinite&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Transient&quot;</span><span class="p">,</span> <span class="s2">&quot;ElectricTransient&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">matrix_name</span><span class="p">:</span>
                <span class="n">matrix_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Matrix&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">turns</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">turns</span><span class="p">,</span> <span class="kc">True</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">turns</span><span class="p">:</span>
                    <span class="n">turns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">turns</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
                    <span class="n">num</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">turns</span><span class="p">,</span> <span class="kc">True</span><span class="p">)))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">turns</span><span class="p">,</span> <span class="kc">True</span><span class="p">)):</span>
                        <span class="n">turns</span> <span class="o">=</span> <span class="n">turns</span><span class="p">[:</span><span class="o">-</span><span class="n">num</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_element</span> <span class="o">=</span> <span class="p">[</span><span class="n">turns</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="n">num</span>
                        <span class="n">turns</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_element</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">turns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">turns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">turns</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">return_path</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">return_path</span><span class="p">,</span> <span class="kc">True</span><span class="p">)):</span>
                <span class="n">return_path</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;infinite&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">return_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">return_path</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">item</span> <span class="ow">in</span> <span class="n">return_path</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Return path specified must not be included in sources&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">group_sources</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;EddyCurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;Magnetostatic&quot;</span><span class="p">]:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;MatrixEntry&quot;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;MatrixEntry&quot;</span><span class="p">:</span> <span class="p">[]}),</span> <span class="s2">&quot;MatrixGroup&quot;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;MatrixGroup&quot;</span><span class="p">:</span> <span class="p">[]})}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;MatrixEntry&quot;</span><span class="p">:</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;MatrixEntry&quot;</span><span class="p">:</span> <span class="p">[]}),</span> <span class="s2">&quot;MatrixGroup&quot;</span><span class="p">:</span> <span class="p">[]})</span>

            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sources</span><span class="p">)):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;Magnetostatic&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_type</span> <span class="o">==</span> <span class="s2">&quot;Maxwell 2D&quot;</span><span class="p">:</span>
                    <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;Source&quot;</span><span class="p">:</span> <span class="n">sources</span><span class="p">[</span><span class="n">element</span><span class="p">],</span>
                            <span class="s2">&quot;NumberOfTurns&quot;</span><span class="p">:</span> <span class="n">turns</span><span class="p">[</span><span class="n">element</span><span class="p">],</span>
                            <span class="s2">&quot;ReturnPath&quot;</span><span class="p">:</span> <span class="n">return_path</span><span class="p">[</span><span class="n">element</span><span class="p">],</span>
                        <span class="p">}</span>
                    <span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;EddyCurrent&quot;</span><span class="p">:</span>
                    <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Source&quot;</span><span class="p">:</span> <span class="n">sources</span><span class="p">[</span><span class="n">element</span><span class="p">],</span> <span class="s2">&quot;ReturnPath&quot;</span><span class="p">:</span> <span class="n">return_path</span><span class="p">[</span><span class="n">element</span><span class="p">]})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Source&quot;</span><span class="p">:</span> <span class="n">sources</span><span class="p">[</span><span class="n">element</span><span class="p">],</span> <span class="s2">&quot;NumberOfTurns&quot;</span><span class="p">:</span> <span class="n">turns</span><span class="p">[</span><span class="n">element</span><span class="p">]})</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;MatrixEntry&quot;</span><span class="p">][</span><span class="s2">&quot;MatrixEntry&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">group_sources</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Electrostatic&quot;</span><span class="p">,</span> <span class="s2">&quot;ACConduction&quot;</span><span class="p">,</span> <span class="s2">&quot;DCConduction&quot;</span><span class="p">]:</span>
                    <span class="n">source_list</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">group_sources</span><span class="p">)</span>
                    <span class="n">props</span><span class="p">[</span><span class="s2">&quot;GroundSources&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_list</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">cont</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">group_sources</span><span class="p">:</span>
                        <span class="n">source_list</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">group_sources</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
                        <span class="c1"># GroundSources</span>
                        <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                            <span class="p">{</span><span class="s2">&quot;GroupName&quot;</span><span class="p">:</span> <span class="n">element</span><span class="p">,</span> <span class="s2">&quot;NumberOfBranches&quot;</span><span class="p">:</span> <span class="n">branches</span><span class="p">[</span><span class="n">cont</span><span class="p">],</span> <span class="s2">&quot;Sources&quot;</span><span class="p">:</span> <span class="n">source_list</span><span class="p">}</span>
                        <span class="p">)</span>
                        <span class="n">props</span><span class="p">[</span><span class="s2">&quot;MatrixGroup&quot;</span><span class="p">][</span><span class="s2">&quot;MatrixGroup&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
                        <span class="n">cont</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">bound</span> <span class="o">=</span> <span class="n">MaxwellParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">matrix_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Matrix&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Solution Type has not Matrix Parameter&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">setup_ctrlprog</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">setupname</span><span class="p">,</span> <span class="n">file_str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keep_modifications</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">python_interpreter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">aedt_lib_dir</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Configure the transient design setup to run a specific control program.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        setupname : str</span>
<span class="sd">            Name of the setup.</span>
<span class="sd">        file_str : str, optional</span>
<span class="sd">            Name of the file. The default value is ``None``.</span>
<span class="sd">        keep_modifications : bool, optional</span>
<span class="sd">            Whether to save the changes. The default value is ``False``.</span>
<span class="sd">        python_interpreter : str, optional</span>
<span class="sd">             The default value is ``None``.</span>
<span class="sd">        aedt_lib_dir : str, optional</span>
<span class="sd">             Full path to the ``pyaedt`` directory. The default value is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful and ``False`` when failed.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_py_file</span> <span class="o">=</span> <span class="n">setupname</span> <span class="o">+</span> <span class="s2">&quot;.py&quot;</span>
        <span class="n">ctl_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span>
        <span class="n">ctl_file_compute</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ctl_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_py_file</span><span class="p">)</span>
        <span class="n">ctl_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_py_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">aedt_lib_dir</span><span class="p">:</span>
            <span class="n">source_dir</span> <span class="o">=</span> <span class="n">aedt_lib_dir</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">source_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pyaedt_dir</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ctl_file</span><span class="p">)</span> <span class="ow">and</span> <span class="n">keep_modifications</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ctl_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
                <span class="n">existing_data</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ctl_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
                <span class="n">first_line</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">existing_data</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">first_line</span><span class="p">:</span>
                        <span class="n">first_line</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">if</span> <span class="n">python_interpreter</span><span class="p">:</span>
                            <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;#!</span><span class="si">{0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">python_interpreter</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;work_dir&quot;</span><span class="p">):</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;work_dir = r&#39;</span><span class="si">{0}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ctl_path</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;lib_dir&quot;</span><span class="p">):</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;lib_dir = r&#39;</span><span class="si">{0}</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">source_dir</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">file_str</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">ctl_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
                    <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_str</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">ctl_file</span><span class="p">),</span> <span class="s2">&quot;Control program file could not be created.&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">oanalysis</span><span class="o">.</span><span class="n">EditSetup</span><span class="p">(</span>
            <span class="n">setupname</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="s2">&quot;NAME:&quot;</span> <span class="o">+</span> <span class="n">setupname</span><span class="p">,</span>
                <span class="s2">&quot;Enabled:=&quot;</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;UseControlProgram:=&quot;</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
                <span class="s2">&quot;ControlProgramName:=&quot;</span><span class="p">,</span>
                <span class="n">ctl_file_compute</span><span class="p">,</span>
                <span class="s2">&quot;ControlProgramArg:=&quot;</span><span class="p">,</span>
                <span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="s2">&quot;CallCtrlProgAfterLastStep:=&quot;</span><span class="p">,</span>
                <span class="kc">True</span><span class="p">,</span>
            <span class="p">],</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># Set eddy effects</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">eddy_effects_on</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">activate_eddy_effects</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">activate_displacement_current</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign eddy effects on objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        object_list : list</span>
<span class="sd">            List of objects.</span>
<span class="sd">        activate_eddy_effects : bool, optional</span>
<span class="sd">            Whether to activate eddy effects. The default is ``True``.</span>
<span class="sd">        activate_displacement_current : bool, optional</span>
<span class="sd">            Whether to activate eddy effects. The default is ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful and ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.SetEddyEffect</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">solid_objects_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_all_conductors_names</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">activate_eddy_effects</span><span class="p">:</span>
            <span class="n">activate_displacement_current</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">EddyVector</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NAME:EddyEffectVector&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">solid_objects_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">object_list</span><span class="p">:</span>
                <span class="n">EddyVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:Data&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Object Name:=&quot;</span><span class="p">,</span>
                        <span class="n">obj</span><span class="p">,</span>
                        <span class="s2">&quot;Eddy Effect:=&quot;</span><span class="p">,</span>
                        <span class="n">activate_eddy_effects</span><span class="p">,</span>
                        <span class="s2">&quot;Displacement Current:=&quot;</span><span class="p">,</span>
                        <span class="n">activate_displacement_current</span><span class="p">,</span>
                    <span class="p">]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">EddyVector</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="s2">&quot;NAME:Data&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Object Name:=&quot;</span><span class="p">,</span>
                        <span class="n">obj</span><span class="p">,</span>
                        <span class="s2">&quot;Eddy Effect:=&quot;</span><span class="p">,</span>
                        <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">GetEddyEffect</span><span class="p">(</span><span class="n">obj</span><span class="p">)),</span>
                        <span class="s2">&quot;Displacement Current:=&quot;</span><span class="p">,</span>
                        <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">GetDisplacementCurrent</span><span class="p">(</span><span class="n">obj</span><span class="p">)),</span>
                    <span class="p">]</span>
                <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">SetEddyEffect</span><span class="p">([</span><span class="s2">&quot;NAME:Eddy Effect Setting&quot;</span><span class="p">,</span> <span class="n">EddyVector</span><span class="p">])</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">setup_y_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">windings_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setup the y connection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        winding_name : list, optional</span>
<span class="sd">            List of windings. For instance [&quot;PhaseA&quot;, &quot;PhaseB&quot;, &quot;PhaseC&quot;].</span>
<span class="sd">            The default value is ``None``. In that case the design have none Y connection.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful and ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.SetupYConnection</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        Setup Y Connection for three existing windings respectively named ``PhaseA``, ``PhaseB``, ``PhaseC``.</span>
<span class="sd">        This will create one ``YConnection`` group containing those 3 phases.</span>

<span class="sd">        &gt;&gt;&gt; from pyaedt import Maxwell2d</span>
<span class="sd">        &gt;&gt;&gt; aedtapp = Maxwell2d(&quot;Motor_EM_R2019R3.aedt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; aedtapp.set_active_design(&quot;Basis_Model_For_Test&quot;)</span>
<span class="sd">        &gt;&gt;&gt; aedtapp.setup_y_connection([&quot;PhaseA&quot;, &quot;PhaseB&quot;, &quot;PhaseC&quot;])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">windings_name</span><span class="p">:</span>
            <span class="n">connection</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NAME:YConnection&quot;</span><span class="p">]</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Windings:=&quot;</span><span class="p">)</span>
            <span class="n">connection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">windings_name</span><span class="p">))</span>
            <span class="n">windings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;NAME:YConnection&quot;</span><span class="p">]</span>
            <span class="n">windings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">SetupYConnection</span><span class="p">(</span><span class="n">windings</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">SetupYConnection</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_current</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">object_list</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="s2">&quot;0deg&quot;</span><span class="p">,</span> <span class="n">solid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">swap_direction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign the source of the current.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        object_list : list</span>
<span class="sd">            List of objects to assign the current source to.</span>
<span class="sd">        amplitude : float, optional</span>
<span class="sd">            Current amplitude in mA. The default is ``1``.</span>
<span class="sd">        phase : str, optional</span>
<span class="sd">            The default is ``&quot;0deg&quot;``.</span>
<span class="sd">        solid : bool, optional</span>
<span class="sd">            The default is ``True``.</span>
<span class="sd">        swap_direction : bool, optional</span>
<span class="sd">            The default is ``False``.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignCurrent</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;A&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Current&quot;</span><span class="p">)</span>

        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">object_list</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Faces&quot;</span><span class="p">:</span> <span class="n">object_list</span><span class="p">,</span>
                        <span class="s2">&quot;Current&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">object_list</span><span class="p">,</span>
                        <span class="s2">&quot;Current&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Magnetostatic&quot;</span><span class="p">,</span> <span class="s2">&quot;DCConduction&quot;</span><span class="p">,</span> <span class="s2">&quot;ElectricTransient&quot;</span><span class="p">]:</span>
                <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Phase&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;DCConduction&quot;</span><span class="p">,</span> <span class="s2">&quot;ElectricTransient&quot;</span><span class="p">]:</span>
                    <span class="n">props</span><span class="p">[</span><span class="s2">&quot;IsSolid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">solid</span>
            <span class="n">props</span><span class="p">[</span><span class="s2">&quot;Point out of terminal&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">swap_direction</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">object_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
                <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">object_list</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">,</span> <span class="s2">&quot;IsPositive&quot;</span><span class="p">:</span> <span class="n">swap_direction</span><span class="p">})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Input has to be a 2D Object.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Current&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_translate_motion</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">band_object</span><span class="p">,</span>
        <span class="n">coordinate_system</span><span class="o">=</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span>
        <span class="n">positive_movement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">start_position</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">periodic_translate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">negative_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">positive_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">velocity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">mechanical_transient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">damping</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">load_force</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">motion_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a translation motion to an object container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        band_object : str</span>
<span class="sd">            Object container.</span>
<span class="sd">        coordinate_system : str, optional</span>
<span class="sd">            Coordinate system name. The default is ``&quot;Global&quot;``.</span>
<span class="sd">        axis :str or int, optional</span>
<span class="sd">            Coordinate system axis. The default is ``&quot;Z&quot;``.</span>
<span class="sd">            It can be a ``pyaedt.generic.constants.AXIS`` enumerator value.</span>
<span class="sd">        positive_movement : bool, optional</span>
<span class="sd">            Whether movement is positive. The default is ``True``.</span>
<span class="sd">        start_position : float or str, optional</span>
<span class="sd">            Starting position of the movement. The default is ``o``. If a float</span>
<span class="sd">            value is used, default modeler units are applied.</span>
<span class="sd">        periodic_translate : bool, optional</span>
<span class="sd">            Whether movement is periodic. The default is ``False``.</span>
<span class="sd">        negative_limit : float or str, optional</span>
<span class="sd">            Negative limit of the movement. The default is ``0``. If a float</span>
<span class="sd">            value is used, the default modeler units are applied.</span>
<span class="sd">        positive_limit : float or str, optional</span>
<span class="sd">            Positive limit of the movement. The default is ``0``. If a float</span>
<span class="sd">            value is used, the default modeler units are applied.</span>
<span class="sd">        velocity : float or str, optional</span>
<span class="sd">            Movement velocity. The default is ``0``. If a float value</span>
<span class="sd">            is used, &quot;m_per_sec&quot; units are applied.</span>
<span class="sd">        mechanical_transient : bool, optional</span>
<span class="sd">            Whether to consider the mechanical movement. The default is ``False``.</span>
<span class="sd">        mass : float or str, optional</span>
<span class="sd">            Mechanical mass. The default is ``1``. If a float value is used, &quot;Kg&quot; units</span>
<span class="sd">            are applied.</span>
<span class="sd">        damping : float, optional</span>
<span class="sd">            Damping factor. The default is ``0``.</span>
<span class="sd">        load_force : float or str, optional</span>
<span class="sd">            Load force. The default is ``0``. If a float value is used, &quot;newton&quot;</span>
<span class="sd">            units are applied.</span>
<span class="sd">        motion_name : str, optional</span>
<span class="sd">            Motion name. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignBand</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="n">SOLUTIONS</span><span class="o">.</span><span class="n">Maxwell3d</span><span class="o">.</span><span class="n">Transient</span><span class="p">,</span> <span class="s2">&quot;Motion applies only to the Transient setup.&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">motion_name</span><span class="p">:</span>
            <span class="n">motion_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Motion&quot;</span><span class="p">)</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">band_object</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Move Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Translate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Coordinate System&quot;</span><span class="p">:</span> <span class="n">coordinate_system</span><span class="p">,</span>
                <span class="s2">&quot;PostProcessing Coordinate System&quot;</span><span class="p">:</span> <span class="n">coordinate_system</span><span class="p">,</span>
                <span class="s2">&quot;Axis&quot;</span><span class="p">:</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">cs_axis_str</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
                <span class="s2">&quot;Is Positive&quot;</span><span class="p">:</span> <span class="n">positive_movement</span><span class="p">,</span>
                <span class="s2">&quot;InitPos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">start_position</span><span class="p">),</span>
                <span class="s2">&quot;TranslatePeriodic&quot;</span><span class="p">:</span> <span class="n">periodic_translate</span><span class="p">,</span>
                <span class="s2">&quot;NegativePos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">negative_limit</span><span class="p">),</span>
                <span class="s2">&quot;PositivePos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">positive_limit</span><span class="p">),</span>
                <span class="s2">&quot;Consider Mechanical Transient&quot;</span><span class="p">:</span> <span class="n">mechanical_transient</span><span class="p">,</span>
                <span class="s2">&quot;Velocity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="s2">&quot;m_per_sec&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Mass&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">mass</span><span class="p">,</span> <span class="s2">&quot;Kg&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Damping&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">damping</span><span class="p">),</span>
                <span class="s2">&quot;Load Force&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">load_force</span><span class="p">,</span> <span class="s2">&quot;newton&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">object_list</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">motion_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Band&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_rotate_motion</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">band_object</span><span class="p">,</span>
        <span class="n">coordinate_system</span><span class="o">=</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span>
        <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span>
        <span class="n">positive_movement</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">start_position</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">has_rotation_limits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">negative_limit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">positive_limit</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span>
        <span class="n">non_cylindrical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">mechanical_transient</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">angular_velocity</span><span class="o">=</span><span class="s2">&quot;0rpm&quot;</span><span class="p">,</span>
        <span class="n">inertia</span><span class="o">=</span><span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="n">damping</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">load_torque</span><span class="o">=</span><span class="s2">&quot;0newton&quot;</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a rotation motion to an object container.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        band_object : str,</span>
<span class="sd">            Object container.</span>
<span class="sd">        coordinate_system : str, optional</span>
<span class="sd">            Coordinate system name. The default is ``&quot;Global&quot;``.</span>
<span class="sd">        axis : str or int, optional</span>
<span class="sd">            Coordinate system axis. The default is ``&quot;Z&quot;``.</span>
<span class="sd">            It can be a ``pyaedt.generic.constants.AXIS`` enumerator value.</span>
<span class="sd">        positive_movement : bool, optional</span>
<span class="sd">            Whether the movement is positive. The default is ``True``.</span>
<span class="sd">        start_position : float or str, optional</span>
<span class="sd">            Starting position of the movement. The default is ``0``. If a float value</span>
<span class="sd">            is used, &quot;deg&quot; units are applied.</span>
<span class="sd">        has_rotation_limits : bool, optional</span>
<span class="sd">            Whether there is a limit in rotation. The default is ``False``.</span>
<span class="sd">        negative_limit : float or str, optional</span>
<span class="sd">            Negative limit of the movement. The default is ``0``. If a float value is</span>
<span class="sd">            used, &quot;deg&quot; units are applied.</span>
<span class="sd">        positive_limit : float or str, optional</span>
<span class="sd">            Positive limit of the movement. The default is ``360``. If a float value is used,</span>
<span class="sd">            &quot;deg&quot; units are applied.</span>
<span class="sd">        non_cylindrical : bool, optional</span>
<span class="sd">            Whether to consider non-cylindrical rotation. The default is ``False``.</span>
<span class="sd">        angular_velocity : float or str, optional</span>
<span class="sd">            Movement velocity. The default is ``&quot;0rpm&quot;``. If a float value is used,</span>
<span class="sd">            &quot;rpm&quot; units are applied.</span>
<span class="sd">        mechanical_transient : bool, optional</span>
<span class="sd">            Whether to consider mechanical movement. The default is ``False``.</span>
<span class="sd">        inertia : float, optional</span>
<span class="sd">            Mechanical inertia. The default is ``1``.</span>
<span class="sd">        damping : float, optional</span>
<span class="sd">            Damping factor. The default is ``0``.</span>
<span class="sd">        load_torque : float or str, optional</span>
<span class="sd">            Load force. The default is ``&quot;0newton&quot;``. If a float value is used,</span>
<span class="sd">            &quot;NewtonMeter&quot; units are applied.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignBand</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="n">SOLUTIONS</span><span class="o">.</span><span class="n">Maxwell3d</span><span class="o">.</span><span class="n">Transient</span><span class="p">,</span> <span class="s2">&quot;Motion applies only to the Transient setup.&quot;</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">omodelsetup</span><span class="o">.</span><span class="n">GetMotionSetupNames</span><span class="p">())</span>
        <span class="n">motion_name</span> <span class="o">=</span> <span class="s2">&quot;MotionSetup&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">object_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">band_object</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Move Type&quot;</span><span class="p">:</span> <span class="s2">&quot;Rotate&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Coordinate System&quot;</span><span class="p">:</span> <span class="n">coordinate_system</span><span class="p">,</span>
                <span class="s2">&quot;Axis&quot;</span><span class="p">:</span> <span class="n">GeometryOperators</span><span class="o">.</span><span class="n">cs_axis_str</span><span class="p">(</span><span class="n">axis</span><span class="p">),</span>
                <span class="s2">&quot;Is Positive&quot;</span><span class="p">:</span> <span class="n">positive_movement</span><span class="p">,</span>
                <span class="s2">&quot;InitPos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">start_position</span><span class="p">,</span> <span class="s2">&quot;deg&quot;</span><span class="p">),</span>
                <span class="s2">&quot;HasRotateLimit&quot;</span><span class="p">:</span> <span class="n">has_rotation_limits</span><span class="p">,</span>
                <span class="s2">&quot;NegativePos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">negative_limit</span><span class="p">,</span> <span class="s2">&quot;deg&quot;</span><span class="p">),</span>
                <span class="s2">&quot;PositivePos&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">positive_limit</span><span class="p">,</span> <span class="s2">&quot;deg&quot;</span><span class="p">),</span>
                <span class="s2">&quot;NonCylindrical&quot;</span><span class="p">:</span> <span class="n">non_cylindrical</span><span class="p">,</span>
                <span class="s2">&quot;Consider Mechanical Transient&quot;</span><span class="p">:</span> <span class="n">mechanical_transient</span><span class="p">,</span>
                <span class="s2">&quot;Angular Velocity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">angular_velocity</span><span class="p">,</span> <span class="s2">&quot;rpm&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Moment of Inertia&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">inertia</span><span class="p">),</span>
                <span class="s2">&quot;Damping&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">damping</span><span class="p">),</span>
                <span class="s2">&quot;Load Torque&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_arg_with_units</span><span class="p">(</span><span class="n">load_torque</span><span class="p">,</span> <span class="s2">&quot;NewtonMeter&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">object_list</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">motion_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Band&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_voltage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face_list</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a voltage source to a list of faces in Maxwell 3D or a list of Objects in Maxwell 2D.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        face_list : list</span>
<span class="sd">            List of faces or objects to assign a voltage source to.</span>
<span class="sd">        amplitude : float, optional</span>
<span class="sd">            Voltage amplitude in mV. The default is ``1``.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the boundary. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignVoltage</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mV&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Voltage&quot;</span><span class="p">)</span>
        <span class="n">face_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">face_list</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="c1"># if type(face_list) is not list and type(face_list) is not tuple:</span>
        <span class="c1">#     face_list = [face_list]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_type</span> <span class="o">==</span> <span class="s2">&quot;Maxwell 2D&quot;</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">face_list</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Faces&quot;</span><span class="p">:</span> <span class="n">face_list</span><span class="p">,</span> <span class="s2">&quot;Voltage&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">})</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Voltage&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_voltage_drop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">face_list</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">swap_direction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a voltage drop to a list of faces.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        face_list : list</span>
<span class="sd">            List of faces to assign a voltage drop to.</span>
<span class="sd">        amplitude : float, optional</span>
<span class="sd">            Voltage amplitude in mV. The default is ``1``.</span>
<span class="sd">        swap_direction : bool, optional</span>
<span class="sd">            Whether to swap the direction. The default value is ``False``.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the boundary. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignVoltageDrop</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">amplitude</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">amplitude</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">amplitude</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;mV&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;VoltageDrop&quot;</span><span class="p">)</span>
        <span class="n">face_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">face_list</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Faces&quot;</span><span class="p">:</span> <span class="n">face_list</span><span class="p">,</span> <span class="s2">&quot;Voltage Drop&quot;</span><span class="p">:</span> <span class="n">amplitude</span><span class="p">,</span> <span class="s2">&quot;Point out of terminal&quot;</span><span class="p">:</span> <span class="n">swap_direction</span><span class="p">})</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;VoltageDrop&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_winding</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">coil_terminals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">winding_type</span><span class="o">=</span><span class="s2">&quot;Current&quot;</span><span class="p">,</span>
        <span class="n">is_solid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">current_value</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">res</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">ind</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">voltage</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">parallel_branches</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a winding to a Maxwell design.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coil_terminals : list, optional</span>
<span class="sd">            List of faces to create the coil terminal on.</span>
<span class="sd">            The default is ``None``.</span>
<span class="sd">        winding_type : str, optional</span>
<span class="sd">            Type of the winding. Options are ``&quot;Current&quot;``, ``&quot;Voltage&quot;``,</span>
<span class="sd">            and ``&quot;External&quot;``. The default is ``&quot;Current&quot;``.</span>
<span class="sd">        is_solid : bool, optional</span>
<span class="sd">            Whether the winding is the solid type. The default is ``True``. If ``False``,</span>
<span class="sd">            the winding is the stranded type.</span>
<span class="sd">        current_value : float, optional</span>
<span class="sd">            Value of the current in amperes. The default is ``1``.</span>
<span class="sd">        res : float, optional</span>
<span class="sd">            Resistance in ohms. The default is ``0``.</span>
<span class="sd">        ind : float, optional</span>
<span class="sd">            Henry. The default is ``0``.</span>
<span class="sd">        voltage : float, optional</span>
<span class="sd">            Voltage value. The default is ``0``.</span>
<span class="sd">        parallel_branches : int, optional</span>
<span class="sd">            The number of parallel branches. The default is ``1``.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            Name of the boundary. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Bounding object for the winding, otherwise only the bounding object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignWindingGroup</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Winding&quot;</span><span class="p">)</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Type&quot;</span><span class="p">:</span> <span class="n">winding_type</span><span class="p">,</span>
                <span class="s2">&quot;IsSolid&quot;</span><span class="p">:</span> <span class="n">is_solid</span><span class="p">,</span>
                <span class="s2">&quot;Current&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">current_value</span><span class="p">,</span> <span class="s2">&quot;A&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Resistance&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="s2">&quot;ohm&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Inductance&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">),</span>
                <span class="s2">&quot;Voltage&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">voltage</span><span class="p">,</span> <span class="s2">&quot;V&quot;</span><span class="p">),</span>
                <span class="s2">&quot;ParallelBranchesNum&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">parallel_branches</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;Winding&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">coil_terminals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">coil_terminals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">coil_terminals</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">coil_terminals</span> <span class="o">=</span> <span class="p">[</span><span class="n">coil_terminals</span><span class="p">]</span>
            <span class="n">coil_names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">coil</span> <span class="ow">in</span> <span class="n">coil_terminals</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">assign_coil</span><span class="p">(</span><span class="n">coil</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">c</span><span class="p">:</span>
                    <span class="n">coil_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">coil_names</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_winding_coils</span><span class="p">(</span><span class="n">bound</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">coil_names</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">add_winding_coils</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">windingname</span><span class="p">,</span> <span class="n">coil_names</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add coils to the winding.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        windingname : str</span>
<span class="sd">            Name of the winding.</span>
<span class="sd">        coil_names : list</span>
<span class="sd">            List of the coil names.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AddWindingTerminals</span>
<span class="sd">        &gt;&gt;&gt; oModule.AddWindingCoils</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_is3d</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">AddWindingTerminals</span><span class="p">(</span><span class="n">windingname</span><span class="p">,</span> <span class="n">coil_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oboundary</span><span class="o">.</span><span class="n">AddWindingCoils</span><span class="p">(</span><span class="n">windingname</span><span class="p">,</span> <span class="n">coil_names</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_coil</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_object</span><span class="p">,</span> <span class="n">conductor_number</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">polarity</span><span class="o">=</span><span class="s2">&quot;Positive&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign coils to a list of objects or face IDs.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_object : list</span>
<span class="sd">            List of objects or face IDs.</span>
<span class="sd">        conductor_number : int, optional</span>
<span class="sd">            Number of conductors. The default is ``1``.</span>
<span class="sd">        polarity : str, optional</span>
<span class="sd">            Type of the polarity. The default is ``&quot;Positive&quot;``.</span>
<span class="sd">        name : str, optional</span>
<span class="sd">            The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        CoilObject</span>
<span class="sd">            Coil object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignCoil</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">polarity</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;positive&quot;</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">input_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">input_object</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Coil&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_object</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_is3d</span><span class="p">:</span>
                <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span> <span class="s2">&quot;Conductor number&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">conductor_number</span><span class="p">),</span> <span class="s2">&quot;Point out of terminal&quot;</span><span class="p">:</span> <span class="n">point</span><span class="p">}</span>
                <span class="p">)</span>
                <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;CoilTerminal&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span>
                        <span class="s2">&quot;Conductor number&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">conductor_number</span><span class="p">),</span>
                        <span class="s2">&quot;PolarityType&quot;</span><span class="p">:</span> <span class="n">polarity</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                    <span class="p">}</span>
                <span class="p">)</span>
                <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;Coil&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_is3d</span><span class="p">:</span>
                <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span><span class="s2">&quot;Faces&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span> <span class="s2">&quot;Conductor number&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">conductor_number</span><span class="p">),</span> <span class="s2">&quot;Point out of terminal&quot;</span><span class="p">:</span> <span class="n">point</span><span class="p">}</span>
                <span class="p">)</span>
                <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;CoilTerminal&quot;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Face Selection is not allowed in Maxwell 2D. Provide a 2D object.&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_force</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_object</span><span class="p">,</span> <span class="n">reference_cs</span><span class="o">=</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="n">is_virtual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a force to one or more objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_object : str, list</span>
<span class="sd">            One or more objects to assign the force to.</span>
<span class="sd">        reference_cs : str, optional</span>
<span class="sd">            Name of the reference coordinate system. The default is ``&quot;Global&quot;``.</span>
<span class="sd">        is_virtual : bool, optional</span>
<span class="sd">            Whether the force is virtual. The default is ``True.``</span>
<span class="sd">        force_name : str, optional</span>
<span class="sd">            Name of the force. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignForce</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ACConduction&quot;</span><span class="p">,</span> <span class="s2">&quot;DCConduction&quot;</span><span class="p">]:</span>
            <span class="n">input_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">input_object</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">force_name</span><span class="p">:</span>
                <span class="n">force_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Force&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_type</span> <span class="o">==</span> <span class="s2">&quot;Maxwell 3D&quot;</span><span class="p">:</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">force_name</span><span class="p">,</span>
                        <span class="s2">&quot;Reference CS&quot;</span><span class="p">:</span> <span class="n">reference_cs</span><span class="p">,</span>
                        <span class="s2">&quot;Is Virtual&quot;</span><span class="p">:</span> <span class="n">is_virtual</span><span class="p">,</span>
                        <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">force_name</span><span class="p">,</span>
                        <span class="s2">&quot;Reference CS&quot;</span><span class="p">:</span> <span class="n">reference_cs</span><span class="p">,</span>
                        <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>

            <span class="n">bound</span> <span class="o">=</span> <span class="n">MaxwellParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_name</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="s2">&quot;Force&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Solution Type has not Matrix Parameter&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_torque</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_object</span><span class="p">,</span> <span class="n">reference_cs</span><span class="o">=</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="n">is_positive</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_virtual</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="n">torque_name</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a torque to one or more objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_object : str or list</span>
<span class="sd">           One or more objects to assign the torque to.</span>
<span class="sd">        reference_cs : str, optional</span>
<span class="sd">            Name of the reference coordinate system. The default is ``&quot;Global&quot;``.</span>
<span class="sd">        is_positive : bool, optional</span>
<span class="sd">            Whether the torque is positive. The default is ``True``.</span>
<span class="sd">        is_virtual : bool, optional</span>
<span class="sd">            Whether the torque is virtual. The default is ``True``.</span>
<span class="sd">        axis : str, optional</span>
<span class="sd">            Axis to apply the torque to. The default is ``&quot;Z&quot;``.</span>
<span class="sd">        torque_name : str, optional</span>
<span class="sd">            Name of the torque. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignTorque</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;ACConduction&quot;</span><span class="p">,</span> <span class="s2">&quot;DCConduction&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="o">==</span> <span class="s2">&quot;Transient&quot;</span><span class="p">:</span>
                <span class="n">is_virtual</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">input_object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">input_object</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">torque_name</span><span class="p">:</span>
                <span class="n">torque_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Torque&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_type</span> <span class="o">==</span> <span class="s2">&quot;Maxwell 3D&quot;</span><span class="p">:</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">torque_name</span><span class="p">,</span>
                        <span class="s2">&quot;Is Virtual&quot;</span><span class="p">:</span> <span class="n">is_virtual</span><span class="p">,</span>
                        <span class="s2">&quot;Coordinate System&quot;</span><span class="p">:</span> <span class="n">reference_cs</span><span class="p">,</span>
                        <span class="s2">&quot;Axis&quot;</span><span class="p">:</span> <span class="n">axis</span><span class="p">,</span>
                        <span class="s2">&quot;Is Positive&quot;</span><span class="p">:</span> <span class="n">is_positive</span><span class="p">,</span>
                        <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prop</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">torque_name</span><span class="p">,</span>
                        <span class="s2">&quot;Coordinate System&quot;</span><span class="p">:</span> <span class="n">reference_cs</span><span class="p">,</span>
                        <span class="s2">&quot;Is Positive&quot;</span><span class="p">:</span> <span class="n">is_positive</span><span class="p">,</span>
                        <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_object</span><span class="p">,</span>
                    <span class="p">}</span>
                <span class="p">)</span>

            <span class="n">bound</span> <span class="o">=</span> <span class="n">MaxwellParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">torque_name</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="s2">&quot;Torque&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Solution Type has not Matrix Parameter&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">solve_inside</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">activate</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Solve inside.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>

<span class="sd">        activate : bool, optional</span>
<span class="sd">            The default value is ``True``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oEditor.ChangeProperty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">solve_inside</span> <span class="o">=</span> <span class="n">activate</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">analyze_from_zero</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Analyze from zero.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.ResetSetupToTimeZero</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oanalysis</span><span class="o">.</span><span class="n">ResetSetupToTimeZero</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_setup</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyze_nominal</span><span class="p">()</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">set_initial_angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">motion_setup</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the initial angle.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        motion_setup : str</span>
<span class="sd">            Name of the motion setup.</span>
<span class="sd">        val : float</span>
<span class="sd">            Value of the angle in degrees.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oDesign.ChangeProperty</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">ChangeProperty</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;NAME:AllTabs&quot;</span><span class="p">,</span>
                <span class="p">[</span>
                    <span class="s2">&quot;NAME:Maxwell2D&quot;</span><span class="p">,</span>
                    <span class="p">[</span><span class="s2">&quot;NAME:PropServers&quot;</span><span class="p">,</span> <span class="s2">&quot;ModelSetup:&quot;</span> <span class="o">+</span> <span class="n">motion_setup</span><span class="p">],</span>
                    <span class="p">[</span><span class="s2">&quot;NAME:ChangedProps&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;NAME:Initial Position&quot;</span><span class="p">,</span> <span class="s2">&quot;Value:=&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">]],</span>
                <span class="p">],</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>


<div class="viewcode-block" id="Maxwell3d"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell3d.html#pyaedt.Maxwell3d">[docs]</a><span class="k">class</span> <span class="nc">Maxwell3d</span><span class="p">(</span><span class="n">Maxwell</span><span class="p">,</span> <span class="n">FieldAnalysis3D</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provides the Maxwell 3D application interface.</span>

<span class="sd">    This class allows you to connect to an existing Maxwell 3D design or create a</span>
<span class="sd">    new Maxwell 3D design if one does not exist.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    projectname : str, optional</span>
<span class="sd">        Name of the project to select or the full path to the project</span>
<span class="sd">        or AEDTZ archive to open. The default is ``None``, in which</span>
<span class="sd">        case an attempt is made to get an active project. If no</span>
<span class="sd">        projects are present, an empty project is created.</span>
<span class="sd">    designname : str, optional</span>
<span class="sd">        Name of the design to select. The default is ``None``, in</span>
<span class="sd">        which case an attempt is made to get an active design. If no</span>
<span class="sd">        designs are present, an empty design is created.</span>
<span class="sd">    solution_type : str, optional</span>
<span class="sd">        Solution type to apply to the design. The default is</span>
<span class="sd">        ``None``, in which case the default type is applied.</span>
<span class="sd">    setup_name : str, optional</span>
<span class="sd">        Name of the setup to use as the nominal. The default is</span>
<span class="sd">        ``None``, in which case the active setup is used or</span>
<span class="sd">        nothing is used.</span>
<span class="sd">    specified_version : str, optional</span>
<span class="sd">        Version of AEDT to use. The default is ``None``, in which case</span>
<span class="sd">        the active version or latest installed version is used. This</span>
<span class="sd">        parameter is ignored when Script is launched within AEDT.</span>
<span class="sd">    non_graphical : bool, optional</span>
<span class="sd">        Whether to launch AEDT in non-graphical mode. The default</span>
<span class="sd">        is ``False``, in which case AEDT is launched in graphical</span>
<span class="sd">        mode. This parameter is ignored when a script is launched within</span>
<span class="sd">        AEDT.</span>
<span class="sd">    new_desktop_session : bool, optional</span>
<span class="sd">        Whether to launch an instance of AEDT in a new thread, even if</span>
<span class="sd">        another instance of the ``specified_version`` is active on the</span>
<span class="sd">        machine. The default is ``True``. This parameter is ignored</span>
<span class="sd">        when Script is launched within AEDT.</span>
<span class="sd">    close_on_exit : bool, optional</span>
<span class="sd">        Whether to release AEDT on exit. The default is ``False``.</span>
<span class="sd">    student_version : bool, optional</span>
<span class="sd">        Whether to open the AEDT student version. The default is</span>
<span class="sd">        ``False``. This parameter is ignored when Script is launched</span>
<span class="sd">        within AEDT.</span>
<span class="sd">    machine : str, optional</span>
<span class="sd">        Machine name to which connect the oDesktop Session. Works only on 2022R2.</span>
<span class="sd">        Remote Server must be up and running with command `&quot;ansysedt.exe -grpcsrv portnum&quot;`.</span>
<span class="sd">        If machine is `&quot;localhost&quot;` the server will also start if not present.</span>
<span class="sd">    port : int, optional</span>
<span class="sd">        Port number of which start the oDesktop communication on already existing server.</span>
<span class="sd">        This parameter is ignored in new server creation. It works only on 2022R2.</span>
<span class="sd">        Remote Server must be up and running with command `&quot;ansysedt.exe -grpcsrv portnum&quot;`.</span>
<span class="sd">    aedt_process_id : int, optional</span>
<span class="sd">        Only used when ``new_desktop_session = False``, specifies by process ID which instance</span>
<span class="sd">        of Electronics Desktop to point PyAEDT at.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Create an instance of Maxwell 3D and open the specified</span>
<span class="sd">    project, which is named ``mymaxwell.aedt``.</span>

<span class="sd">    &gt;&gt;&gt; from pyaedt import Maxwell3d</span>
<span class="sd">    &gt;&gt;&gt; aedtapp = Maxwell3d(&quot;mymaxwell.aedt&quot;)</span>
<span class="sd">    pyaedt info: Added design ...</span>

<span class="sd">    Create an instance of Maxwell 3D using the 2021 R1 release and open</span>
<span class="sd">    the specified project, which is named ``mymaxwell2.aedt``.</span>

<span class="sd">    &gt;&gt;&gt; aedtapp = Maxwell3d(specified_version=&quot;2021.2&quot;, projectname=&quot;mymaxwell2.aedt&quot;)</span>
<span class="sd">    pyaedt info: Added design ...</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>  <span class="c1"># for legacy purposes</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dimensions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;3D&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">projectname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">designname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">solution_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">setup_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">specified_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">non_graphical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">new_desktop_session</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">close_on_exit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">student_version</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">machine</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">aedt_process_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the ``Maxwell`` class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">FieldAnalysis3D</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Maxwell 3D&quot;</span><span class="p">,</span>
            <span class="n">projectname</span><span class="p">,</span>
            <span class="n">designname</span><span class="p">,</span>
            <span class="n">solution_type</span><span class="p">,</span>
            <span class="n">setup_name</span><span class="p">,</span>
            <span class="n">specified_version</span><span class="p">,</span>
            <span class="n">non_graphical</span><span class="p">,</span>
            <span class="n">new_desktop_session</span><span class="p">,</span>
            <span class="n">close_on_exit</span><span class="p">,</span>
            <span class="n">student_version</span><span class="p">,</span>
            <span class="n">machine</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="n">aedt_process_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">Maxwell</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="Maxwell2d"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.html#pyaedt.Maxwell2d">[docs]</a><span class="k">class</span> <span class="nc">Maxwell2d</span><span class="p">(</span><span class="n">Maxwell</span><span class="p">,</span> <span class="n">FieldAnalysis3D</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Provides the Maxwell 2D application interface.</span>

<span class="sd">    This class allows you to connect to an existing Maxwell 2D design or create a</span>
<span class="sd">    new Maxwell 2D design if one does not exist.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    projectname : str, optional</span>
<span class="sd">        Name of the project to select or the full path to the project</span>
<span class="sd">        or AEDTZ archive to open. The default is ``None``, in which</span>
<span class="sd">        case an attempt is made to get an active project. If no</span>
<span class="sd">        projects are present, an empty project is created.</span>
<span class="sd">    designname : str, optional</span>
<span class="sd">        Name of the design to select. The default is ``None``, in</span>
<span class="sd">        which case an attempt is made to get an active design. If no</span>
<span class="sd">        designs are present, an empty design is created.</span>
<span class="sd">    solution_type : str, optional</span>
<span class="sd">        Solution type to apply to the design. The default is</span>
<span class="sd">        ``None``, in which case the default type is applied.</span>
<span class="sd">    setup_name : str, optional</span>
<span class="sd">        Name of the setup to use as the nominal. The default is</span>
<span class="sd">        ``None``, in which case the active setup is used or</span>
<span class="sd">        nothing is used.</span>
<span class="sd">    specified_version : str, optional</span>
<span class="sd">        Version of AEDT to use. The default is ``None``, in which case</span>
<span class="sd">        the active version or latest installed version is used.</span>
<span class="sd">        This parameter is ignored when Script is launched within AEDT.</span>
<span class="sd">    non_graphical : bool, optional</span>
<span class="sd">        Whether to launch AEDT in non-graphical mode. The default</span>
<span class="sd">        is ``False``, in which case AEDT is launched in graphical mode.</span>
<span class="sd">        This parameter is ignored when a script is launched within AEDT.</span>
<span class="sd">    new_desktop_session : bool, optional</span>
<span class="sd">        Whether to launch an instance of AEDT in a new thread, even if</span>
<span class="sd">        another instance of the ``specified_version`` is active on the</span>
<span class="sd">        machine. The default is ``True``. This parameter is ignored when Script is launched within AEDT.</span>
<span class="sd">    close_on_exit : bool, optional</span>
<span class="sd">        Whether to release AEDT on exit. The default is ``False``.</span>
<span class="sd">    student_version : bool, optional</span>
<span class="sd">        Whether to open the AEDT student version. The default is ``False``.</span>
<span class="sd">        This parameter is ignored when Script is launched within AEDT.</span>
<span class="sd">    machine : str, optional</span>
<span class="sd">        Machine name to which connect the oDesktop Session. Works only on 2022R2.</span>
<span class="sd">        Remote Server must be up and running with command `&quot;ansysedt.exe -grpcsrv portnum&quot;`.</span>
<span class="sd">        If machine is `&quot;localhost&quot;` the server will also start if not present.</span>
<span class="sd">    port : int, optional</span>
<span class="sd">        Port number of which start the oDesktop communication on already existing server.</span>
<span class="sd">        This parameter is ignored in new server creation. It works only on 2022R2.</span>
<span class="sd">        Remote Server must be up and running with command `&quot;ansysedt.exe -grpcsrv portnum&quot;`.</span>
<span class="sd">    aedt_process_id : int, optional</span>
<span class="sd">        Only used when ``new_desktop_session = False``, specifies by process ID which instance</span>
<span class="sd">        of Electronics Desktop to point PyAEDT at.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Create an instance of Maxwell 2D and connect to an existing</span>
<span class="sd">    Maxwell 2D design or create a new Maxwell 2D design if one does</span>
<span class="sd">    not exist.</span>

<span class="sd">    &gt;&gt;&gt; from pyaedt import Maxwell2d</span>
<span class="sd">    &gt;&gt;&gt; aedtapp = Maxwell2d()</span>

<span class="sd">    Create an instance of Maxwell 2D and link to a project named</span>
<span class="sd">    ``projectname``. If this project does not exist, create one with</span>
<span class="sd">    this name.</span>

<span class="sd">    &gt;&gt;&gt; aedtapp = Maxwell2d(projectname)</span>

<span class="sd">    Create an instance of Maxwell 2D and link to a design named</span>
<span class="sd">    ``designname`` in a project named ``projectname``.</span>

<span class="sd">    &gt;&gt;&gt; aedtapp = Maxwell2d(projectname,designame)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>  <span class="c1"># for legacy purposes</span>
    <span class="k">def</span> <span class="nf">dim</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dimensions.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">dimension</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">geometry_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Geometry mode.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oDesign.GetGeometryMode&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">odesign</span><span class="o">.</span><span class="n">GetGeometryMode</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">projectname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">designname</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">solution_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">setup_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">specified_version</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">non_graphical</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">new_desktop_session</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">close_on_exit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">student_version</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">machine</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">port</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">aedt_process_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is3d</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">FieldAnalysis3D</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="s2">&quot;Maxwell 2D&quot;</span><span class="p">,</span>
            <span class="n">projectname</span><span class="p">,</span>
            <span class="n">designname</span><span class="p">,</span>
            <span class="n">solution_type</span><span class="p">,</span>
            <span class="n">setup_name</span><span class="p">,</span>
            <span class="n">specified_version</span><span class="p">,</span>
            <span class="n">non_graphical</span><span class="p">,</span>
            <span class="n">new_desktop_session</span><span class="p">,</span>
            <span class="n">close_on_exit</span><span class="p">,</span>
            <span class="n">student_version</span><span class="p">,</span>
            <span class="n">machine</span><span class="p">,</span>
            <span class="n">port</span><span class="p">,</span>
            <span class="n">aedt_process_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">Maxwell</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xy_plane</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Maxwell 2D plane between `True` and `False`.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_solutions</span><span class="o">.</span><span class="n">xy_plane</span>

    <span class="nd">@xy_plane</span><span class="o">.</span><span class="n">setter</span>
    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">xy_plane</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">design_solutions</span><span class="o">.</span><span class="n">xy_plane</span> <span class="o">=</span> <span class="n">value</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Model depth.&quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="s2">&quot;ModelDepth&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_properties</span><span class="p">:</span>
            <span class="n">value_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">design_properties</span><span class="p">[</span><span class="s2">&quot;ModelDepth&quot;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">float_units</span><span class="p">(</span><span class="n">value_str</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_manager</span><span class="p">[</span><span class="n">value_str</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">a</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@model_depth</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">model_depth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set model depth.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_design_settings</span><span class="p">(</span>
            <span class="p">{</span><span class="s2">&quot;ModelDepth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_modeler</span><span class="o">.</span><span class="n">model_units</span><span class="p">)}</span>
        <span class="p">)</span>

<div class="viewcode-block" id="Maxwell2d.generate_design_data"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.generate_design_data.html#pyaedt.Maxwell2d.generate_design_data">[docs]</a>    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">generate_design_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">linefilter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">objectfilter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generate a generic set of design data and store it in the extension directory as ``design_data.json``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        linefilter : optional</span>
<span class="sd">            The default is ``None``.</span>
<span class="sd">        objectfilter : optional</span>
<span class="sd">            The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        bool</span>
<span class="sd">            ``True`` when successful, ``False`` when failed.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">convert</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">convert</span><span class="p">(</span><span class="n">key</span><span class="p">):</span> <span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">return</span> <span class="n">obj</span>

        <span class="n">solid_bodies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">solid_bodies</span>
        <span class="k">if</span> <span class="n">objectfilter</span><span class="p">:</span>
            <span class="n">solid_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">object_id_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">j</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">objectfilter</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">solid_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">object_id_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">design_data</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;Project Directory&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">project_path</span><span class="p">,</span>
            <span class="s2">&quot;Working Directory&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span>
            <span class="s2">&quot;Library Directories&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">library_list</span><span class="p">,</span>
            <span class="s2">&quot;Dimension&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">dimension</span><span class="p">,</span>
            <span class="s2">&quot;GeoMode&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">geometry_mode</span><span class="p">,</span>
            <span class="s2">&quot;ModelUnits&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">model_units</span><span class="p">,</span>
            <span class="s2">&quot;Symmetry&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetry_multiplier</span><span class="p">,</span>
            <span class="s2">&quot;ModelDepth&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_depth</span><span class="p">,</span>
            <span class="s2">&quot;ObjectList&quot;</span><span class="p">:</span> <span class="n">solid_ids</span><span class="p">,</span>
            <span class="s2">&quot;LineList&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">vertex_data_of_lines</span><span class="p">(</span><span class="n">linefilter</span><span class="p">),</span>
            <span class="s2">&quot;VarList&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable_manager</span><span class="o">.</span><span class="n">variable_names</span><span class="p">,</span>
            <span class="s2">&quot;Setups&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">existing_analysis_setups</span><span class="p">,</span>
            <span class="s2">&quot;MaterialProperties&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_material_properties</span><span class="p">(</span><span class="n">solid_bodies</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="n">design_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s2">&quot;design_data.json&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">design_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fps</span><span class="p">:</span>
            <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">design_data</span><span class="p">),</span> <span class="n">fps</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Maxwell2d.read_design_data"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.read_design_data.html#pyaedt.Maxwell2d.read_design_data">[docs]</a>    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">read_design_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Read back the design data as a dictionary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>
<span class="sd">            Dictionary of design data.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">design_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">working_directory</span><span class="p">,</span> <span class="s2">&quot;design_data.json&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">design_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fps</span><span class="p">:</span>
            <span class="n">design_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fps</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">design_data</span></div>

<div class="viewcode-block" id="Maxwell2d.assign_balloon"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.assign_balloon.html#pyaedt.Maxwell2d.assign_balloon">[docs]</a>    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_balloon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">edge_list</span><span class="p">,</span> <span class="n">bound_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a balloon boundary to a list of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        edge_list : list</span>
<span class="sd">            List of edges.</span>
<span class="sd">        bound_name : str, optional</span>
<span class="sd">            Name of the boundary. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Boundary object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignBalloon</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">edge_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">edge_list</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">bound_name</span><span class="p">:</span>
            <span class="n">bound_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Balloon&quot;</span><span class="p">)</span>

        <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Edges&quot;</span><span class="p">:</span> <span class="n">edge_list</span><span class="p">})</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bound_name</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;Balloon&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Maxwell2d.assign_vector_potential"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.assign_vector_potential.html#pyaedt.Maxwell2d.assign_vector_potential">[docs]</a>    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_vector_potential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_edge</span><span class="p">,</span> <span class="n">vectorvalue</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bound_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign a vector to a list of edges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        input_edge : list</span>
<span class="sd">            List of edge names or edge IDs to assign a vector to.</span>
<span class="sd">        vectorvalue : float, optional</span>
<span class="sd">            Value of the vector. The default is ``0``.</span>
<span class="sd">        bound_name : str, optional</span>
<span class="sd">            Name of the boundary. The default is ``None``.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Vector Potential Object</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignVectorPotential</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">input_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">input_edge</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">bound_name</span><span class="p">:</span>
            <span class="n">bound_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Vector&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_edge</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">input_edge</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">vectorvalue</span><span class="p">),</span> <span class="s2">&quot;CoordinateSystem&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Edges&quot;</span><span class="p">:</span> <span class="n">input_edge</span><span class="p">,</span> <span class="s2">&quot;Value&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">vectorvalue</span><span class="p">),</span> <span class="s2">&quot;CoordinateSystem&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">})</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bound_name</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;Vector Potential&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Maxwell2d.assign_master_slave"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.assign_master_slave.html#pyaedt.Maxwell2d.assign_master_slave">[docs]</a>    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_master_slave</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">master_edge</span><span class="p">,</span> <span class="n">slave_edge</span><span class="p">,</span> <span class="n">reverse_master</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">reverse_slave</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">same_as_master</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bound_name</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign master and slave boundary conditions to two edges of the same object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        master_edge : int</span>
<span class="sd">            ID of the master edge.</span>
<span class="sd">        slave_edge : int</span>
<span class="sd">            ID of the slave edge.</span>
<span class="sd">        reverse_master : bool, optional</span>
<span class="sd">            Whether to reverse the master edge to the V direction. The default is ``False``.</span>
<span class="sd">        reverse_slave : bool, optional</span>
<span class="sd">            Whether to reverse the master edge to the U direction. The default is ``False``.</span>
<span class="sd">        same_as_master : bool, optional</span>
<span class="sd">            Whether the B-Field of the slave edge and master edge are the same. The default is ``True``.</span>
<span class="sd">        bound_name : str, optional</span>
<span class="sd">            Name of the master boundary. The name of the slave boundary will have a ``_dep`` suffix.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`, :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            Master and slave objects.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignIndependent</span>
<span class="sd">        &gt;&gt;&gt; oModule.AssignDependent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">master_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">master_edge</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">slave_edge</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">slave_edge</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bound_name</span><span class="p">:</span>
            <span class="n">bound_name_m</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Independent&quot;</span><span class="p">)</span>
            <span class="n">bound_name_s</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;Dependent&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bound_name_m</span> <span class="o">=</span> <span class="n">bound_name</span>
            <span class="n">bound_name_s</span> <span class="o">=</span> <span class="n">bound_name</span> <span class="o">+</span> <span class="s2">&quot;_dep&quot;</span>
        <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">({</span><span class="s2">&quot;Edges&quot;</span><span class="p">:</span> <span class="n">master_edge</span><span class="p">,</span> <span class="s2">&quot;ReverseV&quot;</span><span class="p">:</span> <span class="n">reverse_master</span><span class="p">})</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bound_name_m</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;Independent&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>

            <span class="n">props2</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
                <span class="p">{</span>
                    <span class="s2">&quot;Edges&quot;</span><span class="p">:</span> <span class="n">slave_edge</span><span class="p">,</span>
                    <span class="s2">&quot;ReverseU&quot;</span><span class="p">:</span> <span class="n">reverse_slave</span><span class="p">,</span>
                    <span class="s2">&quot;Independent&quot;</span><span class="p">:</span> <span class="n">bound_name_m</span><span class="p">,</span>
                    <span class="s2">&quot;SameAsMaster&quot;</span><span class="p">:</span> <span class="n">same_as_master</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">)</span>
            <span class="n">bound2</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bound_name_s</span><span class="p">,</span> <span class="n">props2</span><span class="p">,</span> <span class="s2">&quot;Dependent&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">bound2</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound2</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">bound</span><span class="p">,</span> <span class="n">bound2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">bound</span><span class="p">,</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Maxwell2d.assign_end_connection"><a class="viewcode-back" href="../../API/_autosummary/pyaedt.Maxwell2d.assign_end_connection.html#pyaedt.Maxwell2d.assign_end_connection">[docs]</a>    <span class="nd">@pyaedt_function_handler</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">assign_end_connection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objects</span><span class="p">,</span> <span class="n">resistance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">inductance</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bound_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Assign End connection to a list of objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        objects : list of int or str or :class:`pyaedt.modeler.Object3d.Object3d`</span>
<span class="sd">            List of objects to apply end connection.</span>
<span class="sd">        resistance : float or str, optional</span>
<span class="sd">            Resistance value. If float is provided then it is assumed in Ohm.</span>
<span class="sd">            The default value is &quot;0ohm&quot;.</span>
<span class="sd">        inductance : float or str, optional</span>
<span class="sd">            Inductance value. If float is provided then it is assumed in Henry.</span>
<span class="sd">            The default value is &quot;0H&quot;.</span>
<span class="sd">        bound_name : str, optional</span>
<span class="sd">            Name of the End connection boundary.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        :class:`pyaedt.modules.Boundary.BoundaryObject`</span>
<span class="sd">            New created object.</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>

<span class="sd">        &gt;&gt;&gt; oModule.AssignEndConnection</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">solution_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;EddyCurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;Transient&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Excitation applicable only to Eddy current or Transient Solver.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;At least 2 objects are needed.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">convert_to_selections</span><span class="p">(</span><span class="n">objects</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">bound_name</span><span class="p">:</span>
            <span class="n">bound_name</span> <span class="o">=</span> <span class="n">generate_unique_name</span><span class="p">(</span><span class="s2">&quot;EndConnection&quot;</span><span class="p">)</span>

        <span class="n">props</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;Objects&quot;</span><span class="p">:</span> <span class="n">objects</span><span class="p">,</span>
                <span class="s2">&quot;ResistanceValue&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">resistance</span><span class="p">,</span> <span class="s2">&quot;ohm&quot;</span><span class="p">),</span>
                <span class="s2">&quot;InductanceValue&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">modeler</span><span class="o">.</span><span class="n">_arg_with_dim</span><span class="p">(</span><span class="n">inductance</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">),</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="n">BoundaryObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bound_name</span><span class="p">,</span> <span class="n">props</span><span class="p">,</span> <span class="s2">&quot;EndConnection&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bound</span><span class="o">.</span><span class="n">create</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">boundaries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">bound</span>
        <span class="k">return</span> <span class="kc">False</span></div></div>
</pre></div>

              </div>
              
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright (c) 2022 ANSYS, Inc. All rights reserved.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>